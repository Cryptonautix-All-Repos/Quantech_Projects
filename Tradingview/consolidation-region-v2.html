<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consolidation Region V2 - Quantech Innovation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-dark: #0a0e27;
            --secondary-dark: #131829;
            --accent-cyan: #00d4ff;
            --accent-blue: #0080ff;
            --text-primary: #ffffff;
            --text-secondary: #b8c5d6;
            --card-bg: #1a1f3a;
            --success: #00ff88;
            --danger: #ff3366;
            --border-color: rgba(0, 212, 255, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--secondary-dark) 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Header */
        header {
            background: rgba(19, 24, 41, 0.95);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .back-btn {
            padding: 0.6rem 1.2rem;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            text-decoration: none;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: var(--accent-cyan);
            color: var(--primary-dark);
            border-color: var(--accent-cyan);
        }

        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
        }

        @media (min-width: 1024px) {
            .container {
                grid-template-columns: 240px 1fr;
            }
        }

        /* Sidebar Navigation */
        .sidebar-nav {
            position: sticky;
            top: 100px; /* Adjust based on header height */
            align-self: start;
        }

        .sidebar-nav h3 {
            font-size: 1.1rem;
            color: var(--accent-cyan);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .sidebar-nav ul {
            list-style: none;
        }

        .sidebar-nav li {
            margin-bottom: 0.75rem;
        }

        .sidebar-nav a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.95rem;
            transition: all 0.2s ease;
            display: block;
            padding: 0.25rem 0;
        }

        .sidebar-nav a:hover {
            color: var(--accent-cyan);
            transform: translateX(5px);
        }

        /* Main Content Sections */
        .content-main {
            background: var(--card-bg);
            border-radius: 15px;
            border: 1px solid var(--border-color);
            padding: 2rem;
        }

        .content-main h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--text-primary), var(--accent-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1.5rem;
        }
        
        .content-section {
            margin-bottom: 3rem;
        }

        .content-section h2 {
            font-size: 1.8rem;
            color: var(--accent-cyan);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .content-section p, .content-section li {
            color: var(--text-secondary);
            font-size: 1.05rem;
            line-height: 1.7;
            margin-bottom: 1rem;
        }

        .content-section ul {
            list-style-position: inside;
            padding-left: 1rem;
        }

        .content-section li {
            margin-bottom: 0.5rem;
        }

        /* Parameter Table */
        .param-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1.5rem;
        }

        .param-table th, .param-table td {
            padding: 0.8rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-secondary);
        }

        .param-table th {
            color: var(--text-primary);
            font-size: 1.1rem;
        }

        .param-table code {
            font-family: 'Courier New', Courier, monospace;
            background: var(--secondary-dark);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.9rem;
            color: var(--accent-cyan);
        }

        /* Image Placeholders */
        .img-placeholder {
            width: 100%;
            height: auto;
            aspect-ratio: 16 / 9;
            max-height: 600px;
            background: var(--secondary-dark);
            border: 2px dashed var(--border-color);
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }

        .img-placeholder p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin: 0;
            padding: 2rem;
        }

        .caption {
            display: block;
            text-align: center;
            color: var(--text-secondary);
            font-style: italic;
            font-size: 0.9rem;
        }

        /* Risk Disclaimer */
        .risk-disclaimer {
            background: rgba(255, 51, 102, 0.1);
            border: 1px solid var(--danger);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        .risk-disclaimer h3 {
            color: var(--danger);
            margin-bottom: 0.5rem;
        }

        .risk-disclaimer p {
            color: var(--text-secondary);
            font-size: 0.95rem;
            margin: 0;
            line-height: 1.6;
        }

        /* Footer */
        footer {
            background: var(--secondary-dark);
            padding: 2rem;
            text-align: center;
            border-top: 1px solid var(--border-color);
            margin-top: 4rem;
        }

        .footer-buttons {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
        }

        .footer-btn {
            padding: 0.8rem 2rem;
            background: linear-gradient(135deg, var(--accent-cyan), var(--accent-blue));
            color: var(--primary-dark);
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .footer-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0, 212, 255, 0.4);
        }
        
        footer p {
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .footer-tagline {
            color: var(--accent-cyan);
            font-size: 0.9rem;
        }

        /* Responsive */
        @media (max-width: 1023px) {
            .sidebar-nav {
                position: static;
                border-bottom: 1px solid var(--border-color);
                padding-bottom: 1rem;
                margin-bottom: 2rem;
            }
            .sidebar-nav ul {
                display: flex;
                flex-wrap: wrap;
                gap: 1rem;
            }
            .sidebar-nav li { margin-bottom: 0; }
        }
        @media (max-width: 768px) {
            header { padding: 1rem; }
            .content-main h1 { font-size: 2rem; }
            .content-section h2 { font-size: 1.5rem; }
            .container { padding: 0 1rem; margin-top: 1.5rem;}
            .content-main { padding: 1.5rem; }
            .param-table { font-size: 0.9rem; }
            .param-table th, .param-table td { padding: 0.6rem 0.5rem; }
            .img-placeholder p { font-size: 1rem; }
        }
    </style>
    <script>
        // Smooth scroll for navigation
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.sidebar-nav a').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring;
                    const targetElement = document.getElementById(targetId);
                    if(targetElement) {
                        targetElement.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
        });
    </script>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">Quantech Innovation</div>
            <a href="index.html" class="back-btn">← Back to Portfolio</a>
        </div>
    </header>

    <div class="container">
        <nav class="sidebar-nav">
            <h3>Quick Navigation</h3>
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#methodology">Methodology & Logic</a></li>
                <li><a href="#parameters">Parameters & Settings</a></li>
                <li><a href="#specs">Technical Specifications</a></li>
                <li><a href="#visuals">Visual Documentation</a></li>
                <li><a href="#usage">Usage Guide</a></li>
                <li><a href="#alerts">Alert Configuration</a></li>
            </ul>
        </nav>

        <main class="content-main">
            <h1>Consolidation Region V2</h1>

            <section id="overview" class="content-section">
                <h2>Overview</h2>
                <p>The Consolidation Region V2 indicator is a specialized tool for identifying and visualizing periods of market consolidation, or "range-bound" price action. It helps traders distinguish between strong trends and sideways "chop," which are critical for applying the correct trading strategy.</p>
                <p>The indicator's core logic is built on two primary components: an advanced **Ehlers Dynamic Smoothed Moving Average (EDSMA)** for trend analysis and dynamic **ATR (Average True Range) Bands** to define the boundaries of consolidation.</p>
                <p>Its key innovation is the **Slope Filter**. This indicator doesn't just identify when price is moving sideways; it cross-references this with the *slope of the underlying EDSMA*. A consolidation is only confirmed if the price is range-bound AND the EDSMA's slope is flat (yellow). This intelligent filter helps to reject "false" consolidations that are actually just slow, grinding trends.</p>
            </section>

            <section id="methodology" class="content-section">
                <h2>Methodology & Logic</h2>
                <p>The indicator identifies consolidation regions through a multi-step confirmation process:</p>
                <ul>
                    <li><strong>1. EDSMA Trend Analysis:</strong> First, the script calculates the EDSMA, a highly adaptive moving average. It then calculates the *slope* of this moving average to determine the market's state:
                        <ul>
                            <li><strong>Bullish Trend:</strong> Steep positive slope (colored green).</li>
                            <li><strong>Bearish Trend:</strong> Steep negative slope (colored red).</li>
                            <li><strong>Consolidation:</strong> Flat slope (colored yellow).</li>
                        </ul>
                    </li>
                    <li><strong>2. Dynamic ATR Bands:</strong> The indicator plots ATR bands (Upper and Lower) around a central source. By default, this source is the EDSMA itself, making the bands dynamic and trend-adaptive.</li>
                    <li><strong>3. Consolidation State Tracking:</strong> A consolidation "state" is tracked based on two conditions:
                        <ul>
                            <li><strong>Price Condition:</strong> The high and low of the current candle must be fully *inside* the dynamic ATR bands.</li>
                            <li><strong>Time Condition:</strong> This "inside" state must persist for a minimum number of bars, defined by the `Min bars for valid consolidation` input.</li>
                        </ul>
                    </li>
                    <li><strong>4. The Slope Filter (Quality Check):</strong> As the indicator counts bars for the time condition, it *also* counts how many of those bars had a "trending" (green or red) EDSMA slope. If the number of trending bars exceeds the `Max Trending Bars Allowed`, the consolidation is considered invalid and rejected. This ensures only true, flat consolidations are flagged.</li>
                    <li><strong>5. Box Visualization:</strong> Once all conditions are met (Price + Time + Slope Filter), the indicator draws a blue box. The top and bottom of this box are not the ATR bands themselves, but the *actual highest high and lowest low* reached during the confirmed consolidation period. The box continues to extend in real-time until a candle's high or low breaks *outside* the ATR bands, or the slope filter is violated.</li>
                </ul>
            </section>

            <section id="parameters" class="content-section">
                <h2>Parameters & Settings</h2>
                <p>The indicator's behavior can be precisely tuned using the following groups of settings.</p>
                <table class="param-table">
                    <thead>
                        <tr>
                            <th>Parameter Group</th>
                            <th>Key Inputs</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>EDSMA Parameters</code></td>
                            <td><code>EDSMA Source</code>, <code>EDSMA Length</code>, <code>SSF Length</code>, <code>SSF Poles</code></td>
                            <td>Controls the core adaptive moving average. <code>EDSMA Length</code> sets its primary period, while `SSF` inputs fine-tune the smoothing filter.</td>
                        </tr>
                        <tr>
                            <td><code>Slope Parameters</code></td>
                            <td><code>Slope Period</code>, <code>Slope Initial Range</code>, <code>Consolidation when slope below:</code>, <code>Bull/Bear/Conc Color</code></td>
                            <td>Defines the sensitivity of the slope calculation. The <code>Consolidation when slope below:</code> (<code>flat</code>) input is the key threshold that determines when the EDSMA line turns yellow.</td>
                        </tr>
                        <tr>
                            <td><code>Consolidation Detection</code></td>
                            <td><code>Use EDSMA for ATR Bands</code>, <code>ATR Length</code>, <code>ATR Multiplier</code>, <code>Min bars for valid consolidation</code></td>
                            <td>Controls the main consolidation detection. <code>Use EDSMA</code> (recommended) centers the ATR bands on the EDSMA. <code>ATR Multiplier</code> sets the width of the bands. <code>Min bars...</code> (<code>threshold</code>) sets how long price must be range-bound before a blue box is drawn.</td>
                        </tr>
                        <tr>
                            <td><code>Slope Filter</code></td>
                            <td><code>Enable Slope Filter</code>, <code>Max Trending Bars Allowed</code></td>
                            <td>The essential quality filter. When enabled, this rejects consolidation signals if the EDSMA is trending. <code>Max Trending Bars</code> sets the tolerance (e.g., <code>5</code> allows up to 5 trending bars within a range before invalidating it).</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section id="specs" class="content-section">
                <h2>Technical Specifications</h2>
                <ul>
                    <li><strong>PineScript Version:</strong> v6</li>
                    <li><strong>Indicator Type:</strong> Overlay (plots directly on the main price chart)</li>
                    <li><strong>Repainting:</strong> No. Consolidation boxes are drawn based on confirmed, closed-bar conditions and do not change retroactively.</li>
                    <li><strong>Applicable Timeframes:</strong> All. It is generally more effective on 15-minute timeframes and higher, where consolidation zones are more clearly defined.</li>
                    <li><strong>Asset Classes:</strong> All (Forex, Crypto, Stocks, Indices, Commodities).</li>
                </ul>
            </section>

            <section id="visuals" class="content-section">
                <h2>Visual Documentation</h2>
                <p>The indicator provides several clear visual cues on the chart.</p>
                
                <div class="img-placeholder">
                    <p>Example 1: [Consolidation Region V2] on EUR/USD 1H Chart<br>(Showing a clearly identified consolidation period (blue box) during sideways price action)</p>
                </div>
                <span class="caption">This placeholder demonstrates the primary output: a blue box drawn over a confirmed, flat market region.</span>

                <div class="img-placeholder">
                    <p>Example 2: [Consolidation Region V2] EDSMA Slope Coloring<br>(Showing the EDSMA line colored yellow (flat) inside the blue box, and green/red (trending) outside of it)</p>
                </div>
                <span class="caption">This placeholder highlights the relationship between the EDSMA's slope (yellow) and the formation of a valid consolidation box.</span>

                <div class="img-placeholder">
                    <p>Example 3: [Consolidation Region V2] Slope Filter Rejection<br>(Price is moving sideways within the ATR bands, but the EDSMA line is green (trending), so no blue box is drawn)</p>
                </div>
                <span class="caption">This placeholder illustrates the power of the slope filter, which correctly identifies a "slow grind" up as a trend, not a consolidation, thus filtering out a false signal.</span>
            </section>

            <section id="usage" class="content-section">
                <h2>Usage Guide</h2>
                <p>This indicator is a powerful tool for adapting your strategy to the current market regime.</p>
                <ul>
                    <li><strong>Market Regime Filter:</strong> The primary use is to identify the market's state.
                        <ul>
                            <li><strong>Blue Box / Yellow EDSMA:</strong> The market is in a confirmed consolidation. Trend-following strategies should be avoided. Range-trading or mean-reversion strategies are more appropriate.</li>
                            <li><strong>No Box / Green or Red EDSMA:</strong> The market is trending. Range-trading strategies should be avoided. Trend-following strategies (e.g., pullbacks to the EDSMA) are more appropriate.</li>
                        </ul>
                    </li>
                    <li><strong>Breakout Trading:</strong> The blue boxes clearly define support and resistance levels (the top and bottom of the box). A strong price break *out* of a confirmed (and especially a long) consolidation box is often the start of a new, powerful trend.</li>
                    <li><strong>Range Trading:</strong> While a blue box is actively being drawn, the top and bottom of the box act as dynamic support and resistance. These levels can be used as targets or entry zones for mean-reversion trades.</li>
                    <li><strong>Parameter Tuning:</strong>
                        <ul>
                            <li>For **Day Trading:** You might use a lower `Min bars for valid consolidation` (e.g., 8-12) and a tighter `ATR Multiplier` (e.g., 1.5) to catch shorter-term ranges.</li>
                            <li>For **Swing Trading:** You would use a higher `Min bars...` (e.g., 20+) and a wider `ATR Multiplier` (e.g., 2.0-2.5) to identify major, significant consolidation zones.</li>
                        </ul>
                    </li>
                </ul>
            </section>

            <section id="alerts" class="content-section">
                <h2>Alert Configuration</h2>
                <p>This indicator is designed for visual analysis and does not include built-in `alert()` or `alertcondition()` functions for the consolidation boxes themselves.</p>
                <p>However, you can manually set alerts on the indicator's plotted ATR bands to be notified of a potential *end* to a consolidation (a breakout):</p>
                <ol>
                    <li>Wait for the indicator to plot the "Upper ATR Band" (faint green) and "Lower ATR Band" (faint red).</li>
                    <li>Right-click on the Upper ATR Band plot.</li>
                    <li>Select "Add Alert on [Upper ATR Band]".</li>
                    <li>Set the condition to "Crossing Up" to be notified of a bullish breakout.</li>
                    <li>Repeat for the Lower ATR Band, setting the condition to "Crossing Down" for a bearish breakout.</li>
                </ol>
            </section>

            <div class="risk-disclaimer">
                <h3>Risk Disclaimer</h3>
                <p>Trading involves substantial risk. This indicator is a technical analysis tool and does not guarantee profitable trades. Past performance does not indicate future results. Users should conduct their own analysis and risk assessment before making any trading decisions.</p>
            </div>
        </main>
    </div>

    <footer>
        <div class="footer-buttons">
            <a href="mailto:contact@quantechinnovation.com" class="footer-btn">✉ Contact Us</a>
            <a href="https://portfolio.quantechinnovation.com/" class="footer-btn" target="_blank">🌐 View Portfolio</a>
        </div>
        <p>&copy; 2024 Quantech Innovation. All Rights Reserved.</p>
        <p class="footer-tagline">Built for Professional Traders</p>
    </footer>

</body>
</html>